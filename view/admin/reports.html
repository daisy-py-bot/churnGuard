<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports Page</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="../assets/css/global.css"> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Sidebar (optional if needed) -->
    <div class="sidebar">
        <h3 class="text-center py-4">Bank of America</h3>
        <a href="dashboard.html"><i class="fas fa-tachometer-alt"></i> Dashboard</a>
        <a href="customer_overview.html"><i class="fas fa-users"></i> Customer Overview</a>
        <a href="reports.html"><i class="fas fa-chart-line"></i> Reports</a>
        <a href="#settings"><i class="fas fa-cogs"></i> Settings</a>
        <a href="#logout"><i class="fas fa-sign-out-alt"></i> Logout</a>
    </div>
     <!-- Sidebar Toggle Button (for mobile view) -->
     <button class="sidebar-toggle" onclick="toggleSidebar()">â˜°</button>

    <!-- Main Content -->
    <div class="main-content container">
        <header class="my-4">
            <h1>Reports</h1>
            <p class="lead">Access detailed reports on churn rates, factors, and model performance.</p>
        </header>

        <!-- Monthly Churn Rates Chart -->
        <section class="report-section mb-5">
            <h2>Monthly Churn Rates</h2>
            <canvas id="monthlyChurnChart"></canvas>
        </section>

        <!-- Churn Factors Comparison Chart -->
        <section class="report-section mb-5">
            <h2>Churn Factors Comparison</h2>
            <canvas id="churnFactorsChart"></canvas>
        </section>

        <!-- Model Performance Metrics -->
        <section class="report-section mb-5">
            <h2>Model Performance</h2>
            <div class="row">
                <div class="col-md-4">
                    <p>Accuracy: <span id="accuracy">85%</span></p>
                </div>
                <div class="col-md-4">
                    <p>Precision: <span id="precision">82%</span></p>
                </div>
                <div class="col-md-4">
                    <p>Recall: <span id="recall">78%</span></p>
                </div>
            </div>
            <canvas id="modelPerformanceChart"></canvas>
        </section>

        <!-- Export Options -->
        <section class="report-section mb-5">
            <h2>Export Reports</h2>
            <button class="btn btn-primary" onclick="exportPDF()">Export as PDF</button>
            <button class="btn btn-secondary" onclick="exportExcel()">Export as Excel</button>
        </section>

        <section class="report-section mb-5">
            <h2>Customer Churn Prediction Overview</h2>
    
            <!-- Filter Options -->
            <div class="filters">
                <label for="locationFilter">Location:</label>
                <select id="locationFilter" onchange="updateChart()">
                    <option value="all">All Locations</option>
                    <option value="New York">New York</option>
                    <option value="California">California</option>
                    <option value="Texas">Texas</option>
                    <option value="Florida">Florida</option>
                    <!-- Add more locations as needed -->
                </select>
    
                <label for="ageFilter">Age Group:</label>
                <select id="ageFilter" onchange="updateChart()">
                    <option value="all">All Age Groups</option>
                    <option value="20-30">20-30</option>
                    <option value="30-40">30-40</option>
                    <option value="40-50">40-50</option>
                    <option value="50+">50+</option>
                    <!-- Add more age groups as needed -->
                </select>
            </div>
    
            <!-- Churn Prediction Chart -->
            <canvas id="churnPredictionChart"></canvas>
        </section>
    

    </div>


    <script>
        const churnPredictionCtx = document.getElementById('churnPredictionChart').getContext('2d');

        // Sample Data (replace with dynamic data)
        const allChurnData = [
            { x: 85, y: 5, r: 45, ageGroup: "20-30", location: "New York", risk: "high", name: "John Doe" },
            { x: 55, y: 7, r: 25, ageGroup: "30-40", location: "California", risk: "medium", name: "Jane Smith" },
            { x: 10, y: 6, r: 10, ageGroup: "20-30", location: "Texas", risk: "low", name: "Mike Johnson" },
            { x: 70, y: 8, r: 50, ageGroup: "40-50", location: "Florida", risk: "high", name: "Emily Davis" },
            // ...add more data points up to 20 with high churn predictions
        ];

        // Initialize Chart.js bubble chart
        let churnChart = new Chart(churnPredictionCtx, {
            type: 'bubble',
            data: {
                datasets: formatChartData(allChurnData)
            },
            options: {
                responsive: true,
                elements: {
                    point: {
                        radius: (context) => context.raw.r,
                        maxRadius: 15 // Set maximum radius for bubbles
                    }
                },
                plugins: {
                    tooltip: {
                        callbacks: {
                            label: (context) => {
                                const customer = allChurnData[context.dataIndex];
                                return [
                                    `Name: ${customer.name}`,
                                    `Age Group: ${customer.ageGroup}`,
                                    `Location: ${customer.location}`,
                                    `Churn Prediction: ${customer.r}%`
                                ];
                            }
                        }
                    },
                    legend: { display: false }
                },
                scales: {
                    x: {
                        title: { display: true, text: 'Predicted Churn Rate (%)' },
                        min: 0,
                        max: 100
                    },
                    y: {
                        title: { display: true, text: 'Customer Score' },
                        min: 0,
                        max: 10
                    }
                }
            }
        });

        // Function to filter data based on selected filters
        function updateChart() {
            const locationFilter = document.getElementById('locationFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;

            const filteredData = allChurnData.filter(customer => {
                return (locationFilter === 'all' || customer.location === locationFilter) &&
                       (ageFilter === 'all' || customer.ageGroup === ageFilter);
            });

            // Update chart with filtered data
            churnChart.data.datasets = formatChartData(filteredData);
            churnChart.update();
        }

        // Helper function to format data for Chart.js
        function formatChartData(data) {
            return data.map((customer) => ({
                label: customer.name,
                data: [{ x: customer.x, y: customer.y, r: customer.r }],
                backgroundColor: getColorByRisk(customer.risk),
                hoverBackgroundColor: 'rgba(0, 0, 0, 0.8)'
            }));
        }

        // Helper function to assign color based on churn risk
        function getColorByRisk(risk) {
            const colors = {
                "high": 'rgba(255, 99, 132, 0.6)',   // red
                "medium": 'rgba(255, 159, 64, 0.6)', // orange
                "low": 'rgba(75, 192, 192, 0.6)'     // green
            };
            return colors[risk] || 'rgba(201, 203, 207, 0.6)'; // Default color if no match
        }
    </script>


    <script>
        // Chart.js for Monthly Churn Rates
        const monthlyChurnCtx = document.getElementById('monthlyChurnChart').getContext('2d');
        new Chart(monthlyChurnCtx, {
            type: 'line',
            data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
                datasets: [{
                    label: 'Churn Rate (%)',
                    data: [5, 6, 4, 7, 5, 8, 6, 9, 5, 7, 6, 8], // Example data
                    borderColor: 'rgba(75, 192, 192, 1)',
                    fill: false
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'top' } },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Chart.js for Churn Factors Comparison
        const churnFactorsCtx = document.getElementById('churnFactorsChart').getContext('2d');
        new Chart(churnFactorsCtx, {
            type: 'bar',
            data: {
                labels: ['Age Group 20-30', '30-40', '40-50', '50+'],
                datasets: [{
                    label: 'Churn Rate (%)',
                    data: [12, 18, 10, 14], // Example data
                    backgroundColor: 'rgba(153, 102, 255, 0.5)',
                    borderColor: 'rgba(153, 102, 255, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'top' } },
                scales: { y: { beginAtZero: true } }
            }
        });

        // Chart.js for Model Performance
        const modelPerformanceCtx = document.getElementById('modelPerformanceChart').getContext('2d');
        new Chart(modelPerformanceCtx, {
            type: 'radar',
            data: {
                labels: ['Accuracy', 'Precision', 'Recall', 'F1 Score'],
                datasets: [{
                    label: 'Model Performance',
                    data: [85, 82, 78, 80], // Example data
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    borderColor: 'rgba(255, 99, 132, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: { legend: { position: 'top' } }
            }
        });

        // Export as PDF (mock function)
        function exportPDF() {
            alert("PDF export functionality will be implemented here.");
        }

        // Export as Excel (mock function)
        function exportExcel() {
            alert("Excel export functionality will be implemented here.");
        }
    </script>

    <!-- Optional: Include jQuery and Bootstrap JS for UI elements -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>





<!-- <script>
    const churnPredictionCtx = document.getElementById('churnPredictionChart').getContext('2d');

    // Sample Data (replace with dynamic data)
    const churnData = [
        { x: 25, y: 5, r: 15, ageGroup: "20-30", location: "New York", name: "John Doe" },
        { x: 35, y: 7, r: 25, ageGroup: "30-40", location: "California", name: "Jane Smith" },
        { x: 20, y: 6, r: 20, ageGroup: "20-30", location: "Texas", name: "Mike Johnson" },
        { x: 40, y: 8, r: 10, ageGroup: "40-50", location: "Florida", name: "Emily Davis" },
        // ...add more data points up to 20 with high churn predictions
    ];

    // Chart.js bubble chart for churn prediction
    new Chart(churnPredictionCtx, {
        type: 'bubble',
        data: {
            datasets: churnData.map((customer, index) => ({
                label: customer.name,
                data: [{ x: customer.x, y: customer.y, r: customer.r }],
                backgroundColor: getColorByAgeGroup(customer.ageGroup),
                hoverBackgroundColor: 'rgba(0, 0, 0, 0.8)'
            }))
        },
        options: {
            responsive: true,
            plugins: {
                tooltip: {
                    callbacks: {
                        label: (context) => {
                            const customer = churnData[context.dataIndex];
                            return [
                                `Name: ${customer.name}`,
                                `Age Group: ${customer.ageGroup}`,
                                `Location: ${customer.location}`,
                                `Churn Prediction: ${customer.r}%`
                            ];
                        }
                    }
                },
                legend: { display: false }
            },
            scales: {
                x: {
                    title: { display: true, text: 'Predicted Churn Rate (%)' },
                    min: 0,
                    max: 50
                },
                y: {
                    title: { display: true, text: 'Customer Score' },
                    min: 0,
                    max: 10
                }
            }
        }
    });

    // Helper function to assign color based on age group or location
    function getColorByAgeGroup(ageGroup) {
        const colors = {
            "20-30": 'rgba(75, 192, 192, 0.6)',
            "30-40": 'rgba(153, 102, 255, 0.6)',
            "40-50": 'rgba(255, 159, 64, 0.6)',
            "50+": 'rgba(255, 99, 132, 0.6)'
        };
        return colors[ageGroup] || 'rgba(201, 203, 207, 0.6)'; // Default color if no match
    }
</script> -->

</body>
</html>
